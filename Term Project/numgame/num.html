<html>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@900&display=swap" rel="stylesheet">
    <!-- google font-->
    <link href="../style.css" rel="stylesheet" />


    <style>
        .is1{ margin: auto;width: 50%;}
        .img{ width: 200;height: 150;opacity:1;}
    </style>

    <body class="s1">
        <nav class=".navbar .navbar-expand{-sm|-md|-lg|-xl}">
            <center>
                <div>
                    <a href="../index.html">回主頁</a>
                    台北市中山區

                </div>
            </center>
        </nav>
        <div class="container flex ">
            <div class="is1" id="output">
                <center>
                    <span>猜數字</span>
                    <input type="number" max="4" value="" id="input" onchange="">
                    <input type="button" value="start" onclick="guess()" id="button">
                </center>

            </div>
        </div>
        <center>
            <div id="target" class="s1">
                <input type="range" min="2" max="10" step="2" value="4" id="inputg1"  onchange="update()">
                <button onclick="creat()" id="buttong1" >翻牌遊戲 Game start size=4*4</button>
            </div>
        </center>
        <script>
            var selecter =1
            var inter 
            var arry=["大佳河濱公園","大佳河濱公園2","台北萬豪酒店","美麗華","國民革命忠烈祠","國民革命忠烈祠2",
            "捷運站","圓山大飯店","臺北市立美術館","劍潭古寺","大佳河濱公園","大佳河濱公園2"]
        
            var nexttime = Math.floor(Math.random()*3000)+1000
            function spin(){
                inter = setInterval(frame,50)
                setTimeout(stop,nexttime)
            }
        
            function frame(){
                console.log("select="+selecter) 
                document.getElementById(selecter).style.opacity = 0.3;
                selecter+=1
                if (selecter==13){
                    selecter=1
                }
                document.getElementById(selecter).style.opacity = 1;
            }
        
            function stop(){
                clearInterval(inter)
                var name = document.getElementById("name").value
                document.getElementById("r").innerHTML=name+" got "+arry[selecter-1]
            }
        </script>
        
        

               <center>
                <div>命運轉輪</div>
                    <table border="2">
                        <tr class="img">
                            <td id="1"><img src="0.jpg" alt="ohno"class="img"></td>
                            <td id="2"><img src="1.jpg" alt="ohno"class="img"></td>
                            <td id="3"><img src="2.jpg" alt="ohno"class="img"></td>
                            <td id="4"><img src="3.jpg" alt="ohno"class="img"></td>
                        </tr>
                        <tr>
                            <td id="5"><img src="4.jpg" alt="ohno"class="img"></td>
                            <td></td>
                            <td></td>
                            <td id="6"><img src="5.jpg" alt="ohno"class="img"></td>
                        </tr>
                        <tr>
                            <td id="7"><img src="6.jpg" alt="ohno"class="img"></td>
                            <td></td>
                            <td></td>
                            <td id="8"><img src="7.jpg" alt="ohno"class="img"></td>
                        </tr>
                        <tr>
                            <td id="9"><img src="8.jpg" alt="ohno"class="img"></td>
                            <td id="10"><img src="9.jpg" alt="ohno"class="img"></td>
                            <td id="11"><img src="0.jpg" alt="ohno"class="img"></td>
                            <td id="12"><img src="1.jpg" alt="ohno"class="img"></td>
                        </tr>
                    </table>
                    <input id = "name"type="text">
                    <button onclick="spin()">spin</button>
                    <h1 id="r">result:</h1>
                </center>
            
    </body>


    <script>
        var list=[0,1,2,3,4,5,6,7,8,9]
        var target=[]
        var container=[]

        function rand(max) {return Math.floor(Math.random()*max)}
        setInterval("change()",50)
        for(i=0;i<4;i++){
            var r= rand(list.length)
            target.push(list[r])
            list.splice(r,1)
            console.log(target);
        }

        function guess(){
            var a=0
            var b=0
            var input=document.getElementById("input").value
            input=par(input)
            if(input.length!=4){
                alert("enter 4 number!")
                return
            }
            for(i in input){
                if (target.includes(input[i])){
                    if (target[i]==input[i]){
                        a++
                    }
                    else{
                        b++
                    }
                }
            }//finish
            document.getElementById("input").value=""
            var output = document.createElement("div")
            container.push(output)
            output.innerHTML=input+" = "+a+"A "+b+"B"
            document.getElementById("output").appendChild(output)
            if(a==4){
                alert("You Win!!!")
                document.getElementById("button").value="clear"
                document.getElementById("button").onclick=clear
            }
        }
        function change(){
            var input=document.getElementById("input").value
            input=par(input)
            var num=input.pop()
            if (input.includes(num)){
                var n=""
                for(i in input){n+=input[i]}
                document.getElementById("input").value =n
            }
            else{
                if(input.length>=4){
                    console.log(input.length);
                    var n=""
                    for(i in input){n+=input[i]}
                    document.getElementById("input").value =n
                }
            }
        }
        function par(input) {
            input=String(input).split("")
            for (i in input){
                input[i]=Number(input[i])
            }
            return(input)
        }
        function clear() {
            for (i in container){
                container[i].remove()
            }
            list=[0,1,2,3,4,5,6,7,8,9]
            target=[]
            container=[]
            for(i=0;i<4;i++){
                var r= rand(list.length)
                target.push(list[r])
                list.splice(r,1)
                console.log(target);
            }
            document.getElementById("button").value="start"
            document.getElementById("button").onclick=guess
        }
    </script>

<script>
    var source=[] //圖片讀取
    var normal="card1.png"
    var cardc=10
    for(i=0;i<cardc;i++){
        var c = i+".jpg"
        source.push(c)
        }


    function ran(max){
        return Math.floor(Math.random()*max)
    }
    var maxpoint=0
    function newpool(x){ //新牌
        var pool=[]
        var rep=[]
        x=x*x
        maxpoint=x
        for(i=0;i<x;i+=2){
            var re =ran(cardc)
            pool.push(re)
            pool.push(re)
        }
        console.log("source="+source);
        for(i=0;i<x;i++){
            var r=ran(pool.length)
            rep.push(pool[r])
            pool.splice(r,1)
        }
        return rep
    }


    var select=-1
    var con1
    var con2
    var finish=0
    document.addEventListener('click', function(event) {
        var target = event.target
        if (target.dataset.card == 'card' && target != con1 && finish==1) {



            if (select==-1){ //第一次
                select=target.id
                target.src=source[select]
                con1=target
            }
            else{       //第二次
                con2=target
                finish=0
                if (select==target.id){
                    //配對
                    target.src=source[target.id]
                    console.log("成功");
                    setTimeout("pair(con1,con2,1)",3000)
                    
                }
                else{
                    //失敗
                    target.src=source[target.id]
                    console.log("失敗");
                    setTimeout("pair(con1,con2,0)",3000)
                }
                select=-1
            }
        

        }}
    )
    var point=0
    var normal2="icon.png"
    function pair(con1,con2,s){
        if(s==1)
        {con1.dataset.card=0
        con2.dataset.card=0
        con1.src=normal2
        con2.src=normal2
        point+2
        if (point==maxpoint){
            alert("You Win!")
            point=0
        }
        }
        else{
        con1.src=normal
        con2.src=normal
        }
        finish=1
        
    }



    var last = 5
    var item=[]
    function creat(){
        point=0
        item =[]
        var num = document.getElementById("inputg1").value
        var pool = newpool(num)
        console.log(pool);
        var table = document.createElement("table")
        table.border=1
        var count =0
        for (i=0;i<num;i++){
            var tr = document.createElement("tr")

            for (l=0;l<num;l++){
                count +=1
                var td = document.createElement("td")
                tr.appendChild(td)
                var img = document.createElement("img")
                td.appendChild(img)
                img.className="img"
                img.src=source[pool[0]]
                img.id=pool[0]
                img.dataset.card="card"
                item.push(img)
                pool.shift()
            }
            table.appendChild(tr)  //last edit
        }
        document.getElementById("target").appendChild(table)
        
        if(last!=5){
            document.getElementById("target").removeChild(last)
        }
        last=table
        setTimeout("show()",3000)

    }
    function show(){
        console.log("show finish");
        for (i in item){
            item[i].src=normal
            finish=1
        }
    }
    function update(){ //按鈕文字更新

        var num = document.getElementById("inputg1").value
        document.getElementById("buttong1").innerHTML="Game start size="+num+"*"+num
    }
</script>
</html>